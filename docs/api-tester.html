<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Oriva API Documentation & Tester</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        .header {
            text-align: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        .header p {
            margin: 10px 0 0 0;
            font-size: 1.2em;
            opacity: 0.9;
        }
        .badges {
            margin-top: 20px;
        }
        .badge {
            display: inline-block;
            background: rgba(255,255,255,0.2);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            margin: 0 5px;
        }
        .section {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }
        .section h2 {
            color: #333;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .section h3 {
            color: #555;
            margin-top: 25px;
        }
        .api-key-section {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }
        .api-key-section h2 {
            color: white;
            border-bottom-color: rgba(255,255,255,0.3);
        }
        .endpoint-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .endpoint-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.2s;
        }
        .endpoint-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .endpoint-method {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            font-weight: bold;
            margin-right: 10px;
        }
        .method-get { background: #28a745; color: white; }
        .method-post { background: #007bff; color: white; }
        .method-put { background: #ffc107; color: #333; }
        .method-delete { background: #dc3545; color: white; }
        .endpoint-path {
            font-family: monospace;
            font-weight: bold;
            color: #333;
        }
        .endpoint-description {
            color: #666;
            margin-top: 8px;
            font-size: 0.9em;
        }
        .button-section {
            text-align: center;
            margin: 30px 0;
        }
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            margin: 0 10px;
            transition: transform 0.2s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        button:disabled {
            background: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .clear-btn {
            background: linear-gradient(135deg, #6c757d 0%, #495057 100%);
        }
        .test-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
        }
        input[type="password"], input[type="text"] {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            margin-top: 10px;
            transition: border-color 0.2s;
        }
        input[type="password"]:focus, input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }
        .results {
            background: white;
            border-radius: 15px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            padding: 30px;
        }
        .result-item {
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            background: #f8f9fa;
            transition: all 0.2s;
        }
        .result-item:hover {
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .result-item.error {
            background: #fff5f5;
            border-color: #dc3545;
        }
        .result-item.success {
            background: #f8fff8;
            border-color: #28a745;
        }
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        .endpoint {
            font-weight: bold;
            color: #333;
            font-family: monospace;
        }
        .status-badge {
            padding: 6px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: bold;
        }
        .status-success {
            background: #28a745;
            color: white;
        }
        .status-error {
            background: #dc3545;
            color: white;
        }
        .status-pending {
            background: #ffc107;
            color: #333;
        }
        .error-message {
            color: #dc3545;
            margin-bottom: 15px;
            font-weight: bold;
        }
        .response-data {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            overflow: auto;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 13px;
            margin-top: 15px;
            border: 1px solid #e9ecef;
        }
        .loading {
            text-align: center;
            color: #666;
            font-style: italic;
            padding: 40px;
        }
        .info-box {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .warning-box {
            background: #fff3e0;
            border-left: 4px solid #ff9800;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .success-box {
            background: #e8f5e8;
            border-left: 4px solid #4caf50;
            padding: 20px;
            margin: 20px 0;
            border-radius: 0 8px 8px 0;
        }
        .code-block {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 20px;
            font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 15px 0;
        }
        .toc {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .toc ul {
            list-style: none;
            padding: 0;
        }
        .toc li {
            margin: 8px 0;
        }
        .toc a {
            color: #667eea;
            text-decoration: none;
            font-weight: 500;
        }
        .toc a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üöÄ Oriva API Documentation & Tester</h1>
        <p>Complete API reference and interactive testing tool for the Oriva Platform</p>
        <div class="badges">
            <span class="badge">API v1.0</span>
            <span class="badge">TypeScript 5.0+</span>
            <span class="badge">Node.js 18+</span>
            <span class="badge">MIT License</span>
        </div>
    </div>

    <div class="toc">
        <h2>üìã Table of Contents</h2>
        <ul>
            <li><a href="#overview">üéØ Overview</a></li>
            <li><a href="#authentication">üîê Authentication</a></li>
            <li><a href="#endpoints">üîó API Endpoints</a></li>
            <li><a href="#testing">üß™ Interactive Testing</a></li>
            <li><a href="#examples">üìö Code Examples</a></li>
            <li><a href="#troubleshooting">üö® Troubleshooting</a></li>
        </ul>
    </div>

    <div class="section" id="overview">
        <h2>üéØ Overview</h2>
        <p>The Oriva Platform provides comprehensive APIs for building powerful integrations that extend Oriva's functionality. This documentation covers all available endpoints, authentication methods, and provides an interactive testing environment.</p>

    <div class="info-box">
            <strong>Base URL:</strong> <code>https://api.oriva.io</code><br>
            <strong>API Version:</strong> v1.0<br>
            <strong>Authentication:</strong> Bearer Token (API Key)<br>
            <strong>Content Type:</strong> application/json
        </div>

        <h3>What You Can Build</h3>
        <ul>
            <li>‚úÖ <strong>Entry Management</strong> - Create, read, update entries</li>
            <li>‚úÖ <strong>Template System</strong> - Manage templates and workflows</li>
            <li>‚úÖ <strong>User Management</strong> - Access user profiles and data</li>
            <li>‚úÖ <strong>Storage System</strong> - Store and retrieve app data</li>
            <li>‚úÖ <strong>UI Interactions</strong> - Send notifications and alerts</li>
            <li>‚úÖ <strong>Developer Tools</strong> - API key management and analytics</li>
        </ul>
    </div>

    <div class="section" id="authentication">
        <h2>üîê Authentication</h2>
        <p>Oriva uses simple API key authentication. Include your API key in the Authorization header for all requests.</p>
        
        <div class="code-block">
curl -H "Authorization: Bearer YOUR_API_KEY" \
  https://api.oriva.io/api/v1/user/me
        </div>

        <div class="warning-box">
            <strong>‚ö†Ô∏è Security Note:</strong> Keep your API key secure and never expose it in client-side code in production!
        </div>

        <h3>Getting Your API Key</h3>
        <ol>
            <li>Use the admin endpoints to generate a new API key</li>
            <li>Use the <code>/api/v1/dev/generate-key</code> endpoint with your admin token</li>
            <li>Copy your API key (format: <code>oriva_pk_live_...</code> or <code>oriva_pk_test_...</code>)</li>
        </ol>
    </div>

    <div class="section" id="endpoints">
        <h2>üîó API Endpoints</h2>
        
        <h3>üè• Health & Status</h3>
        <div class="endpoint-grid">
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/health</span>
                <div class="endpoint-description">Check API health and status</div>
            </div>
        </div>

        <h3>üë§ User Management</h3>
        <div class="endpoint-grid">
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/user/me</span>
                <div class="endpoint-description">Get current user profile</div>
            </div>
        </div>

        <h3>üìù Entry Management</h3>
        <div class="endpoint-grid">
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/entries</span>
                <div class="endpoint-description">List user entries</div>
            </div>
        </div>

        <h3>üìã Template System</h3>
        <div class="endpoint-grid">
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/templates</span>
                <div class="endpoint-description">List available templates</div>
            </div>
        </div>

        <h3>üíæ Storage System</h3>
        <div class="endpoint-grid">
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/storage</span>
                <div class="endpoint-description">Access app storage</div>
            </div>
        </div>

        <h3>üîî UI Interactions</h3>
        <div class="endpoint-grid">
            <div class="endpoint-card">
                <span class="endpoint-method method-post">POST</span>
                <span class="endpoint-path">/api/v1/ui/notifications</span>
                <div class="endpoint-description">Send notifications to user</div>
            </div>
        </div>

        <h3>üîß Admin Endpoints (Admin Only)</h3>
        <div class="endpoint-grid">
            <div class="endpoint-card">
                <span class="endpoint-method method-get">GET</span>
                <span class="endpoint-path">/api/v1/dev/keys</span>
                <div class="endpoint-description">List API keys (requires X-Admin-Token)</div>
            </div>
            <div class="endpoint-card">
                <span class="endpoint-method method-post">POST</span>
                <span class="endpoint-path">/api/v1/dev/generate-key</span>
                <div class="endpoint-description">Generate new API key (requires X-Admin-Token)</div>
            </div>
            <div class="endpoint-card">
                <span class="endpoint-method method-post">POST</span>
                <span class="endpoint-path">/api/v1/dev/revoke-key</span>
                <div class="endpoint-description">Revoke API key (requires X-Admin-Token)</div>
            </div>
        </div>
    </div>

    <div class="section api-key-section" id="testing">
        <h2>üß™ Interactive API Testing</h2>
        <p>Test the Oriva API endpoints using a secure server-side proxy. This tool helps you verify your integration and explore available endpoints.</p>
        
        <div class="warning-box">
            <strong>üîê Security Notice:</strong> This tester requires a local server setup to securely handle your API key. Never expose API keys in client-side code!
        </div>

        <h3>üöÄ Quick Setup (Recommended)</h3>
        <p>Run this simple Node.js server to test the API securely:</p>
        
        <div class="code-block">
# 1. Create a test server file
cat > test-server.js << 'EOF'
const express = require('express');
const cors = require('cors');
require('dotenv').config();

const app = express();
app.use(cors());
app.use(express.json());

// Proxy endpoint for API testing
app.get('/api/proxy/:endpoint', async (req, res) => {
  const apiKey = process.env.ORIVA_API_KEY;
  const endpoint = req.params.endpoint;
  
  if (!apiKey) {
    return res.status(500).json({ error: 'API key not configured' });
  }
  
  try {
    const response = await fetch(`https://api.oriva.io/api/v1/${endpoint}`, {
      headers: {
        'Authorization': `Bearer ${apiKey}`,
        'Content-Type': 'application/json'
      }
    });
    
    const data = await response.json();
    res.json(data);
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

app.listen(3000, () => {
  console.log('üöÄ Test server running at http://localhost:3000');
  console.log('üìñ Open docs/api-tester.html in your browser');
});
EOF

# 2. Install dependencies
npm install express cors dotenv

# 3. Set your API key
echo "ORIVA_API_KEY=your_api_key_here" > .env

# 4. Start the server
node test-server.js
        </div>

        <h3>üîß Alternative: Python Server</h3>
        <div class="code-block">
# 1. Create test server
cat > test_server.py << 'EOF'
from flask import Flask, jsonify, request
import requests
import os
from flask_cors import CORS

app = Flask(__name__)
CORS(app)

@app.route('/api/proxy/<endpoint>')
def proxy_api(endpoint):
    api_key = os.getenv('ORIVA_API_KEY')
    
    if not api_key:
        return jsonify({'error': 'API key not configured'}), 500
    
    try:
        response = requests.get(
            f'https://api.oriva.io/api/v1/{endpoint}',
            headers={
                'Authorization': f'Bearer {api_key}',
                'Content-Type': 'application/json'
            }
        )
        return jsonify(response.json())
    except Exception as e:
        return jsonify({'error': str(e)}), 500

if __name__ == '__main__':
    app.run(port=3000, debug=True)
EOF

# 2. Install dependencies
pip install flask flask-cors requests python-dotenv

# 3. Set your API key
export ORIVA_API_KEY="your_api_key_here"

# 4. Start the server
python test_server.py
        </div>

        <div class="info-box">
            <strong>‚úÖ Once your server is running:</strong><br>
            1. Open this page in your browser<br>
            2. The tester will automatically use your local server<br>
            3. Your API key stays secure on your machine<br>
            4. Test all endpoints safely!
        </div>
    </div>

    <div class="button-section">
        <button class="test-btn" id="test-btn" onclick="testAllEndpoints()">üöÄ Test All Endpoints</button>
        <button class="clear-btn" onclick="clearResults()">üóëÔ∏è Clear Results</button>
    </div>

    <div class="results">
        <h2>üìä Test Results</h2>
        <div id="results-container">
            <p class="loading">Click "Test All Endpoints" to start testing the Oriva APIs</p>
        </div>
    </div>

    <div class="section" id="examples">
        <h2>üìö Code Examples</h2>
        
        <h3>JavaScript/Node.js</h3>
        <div class="code-block">
// Get user profile
const response = await fetch('https://api.oriva.io/api/v1/user/me', {
  headers: {
    'Authorization': `Bearer ${process.env.ORIVA_API_KEY}`,
    'Content-Type': 'application/json'
  }
});

const user = await response.json();
console.log('User:', user.data.name);
        </div>

        <h3>Send a Notification</h3>
        <div class="code-block">
const notification = await fetch('https://api.oriva.io/api/v1/ui/notifications', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${process.env.ORIVA_API_KEY}`,
    'Content-Type': 'application/json'
  },
  body: JSON.stringify({
    title: 'Hello from your app!',
    message: 'This is a test notification',
    type: 'info'
  })
});

const result = await notification.json();
console.log('Notification sent:', result.success);
        </div>

        <h3>List Entries</h3>
        <div class="code-block">
const entries = await fetch('https://api.oriva.io/api/v1/entries', {
  headers: {
    'Authorization': `Bearer ${process.env.ORIVA_API_KEY}`
  }
});

const data = await entries.json();
console.log('Entries:', data.data);
        </div>
    </div>

    <div class="section" id="troubleshooting">
        <h2>üö® Troubleshooting</h2>
        
        <h3>Common Issues</h3>
        
        <div class="warning-box">
            <strong>401 Unauthorized</strong><br>
            Your API key is invalid or expired. Check that you're using the correct key format and that it hasn't been revoked.
        </div>

        <div class="warning-box">
            <strong>404 Not Found</strong><br>
            The endpoint doesn't exist or isn't implemented yet. Check the endpoint URL and ensure you're using the correct API version.
        </div>

        <div class="warning-box">
            <strong>429 Too Many Requests</strong><br>
            You've exceeded the rate limit. Implement exponential backoff and retry after the specified time.
        </div>

        <h3>Rate Limits</h3>
        <ul>
            <li><strong>Core API:</strong> 5,000 requests per hour</li>
            <li><strong>Admin Endpoints:</strong> 30 requests per minute per IP</li>
            <li><strong>UI Interactions:</strong> 1,000 requests per hour</li>
        </ul>

        <h3>Getting Help</h3>
        <ul>
            <li>üìß <strong>Support:</strong> Use the support system within Oriva Core</li>
            <li>üìö <strong>Documentation:</strong> <a href="https://github.com/0riva/oriva-platform" target="_blank">GitHub Repository</a></li>
            <li>üêõ <strong>Issues:</strong> <a href="https://github.com/0riva/oriva-platform/issues" target="_blank">Report bugs on GitHub</a></li>
            <li>üí° <strong>Discussions:</strong> <a href="https://github.com/0riva/oriva-platform/discussions" target="_blank">Ask questions on GitHub</a></li>
        </ul>
    </div>

    <div class="section">
        <h2>üéâ Ready to Build?</h2>
        <p>You now have everything you need to start building with the Oriva Platform API. Use the interactive tester above to explore endpoints, then integrate them into your applications.</p>
        
        <div class="success-box">
            <strong>üöÄ Next Steps:</strong><br>
            1. Test the endpoints above with your API key<br>
            2. Choose the endpoints you need for your app<br>
            3. Implement the API calls in your code<br>
            4. Build amazing integrations for the Oriva platform!
        </div>
    </div>

    <script>
        const endpoints = [
            { path: 'health', method: 'GET', description: 'API health check' },
            { path: 'user/me', method: 'GET', description: 'Get user profile' },
            { path: 'entries', method: 'GET', description: 'List entries' },
            { path: 'templates', method: 'GET', description: 'List templates' },
            { path: 'storage', method: 'GET', description: 'Access storage' },
            { path: 'dev/keys', method: 'GET', description: 'List API keys (admin only)' }
        ];

        async function testEndpoint(endpoint) {
            const resultDiv = document.createElement('div');
            resultDiv.className = 'result-item';
            resultDiv.innerHTML = `
                <div class="result-header">
                    <span class="endpoint">${endpoint.method} /api/v1/${endpoint.path}</span>
                    <span class="status-badge status-pending">Testing...</span>
                </div>
                <div style="color: #666; font-size: 0.9em; margin-top: 5px;">${endpoint.description}</div>
            `;
            
            document.getElementById('results-container').appendChild(resultDiv);

            try {
                // Try to use local proxy server first
                const proxyUrl = `http://localhost:3000/api/proxy/${endpoint.path}`;
                let response;
                
                try {
                    response = await fetch(proxyUrl, {
                        method: endpoint.method,
                        headers: {
                            'Content-Type': 'application/json',
                        },
                    });
                } catch (proxyError) {
                    // If proxy fails, show setup instructions
                    resultDiv.className = 'result-item error';
                    resultDiv.innerHTML = `
                        <div class="result-header">
                            <span class="endpoint">${endpoint.method} /api/v1/${endpoint.path}</span>
                            <span class="status-badge status-error">Setup Required</span>
                        </div>
                        <div style="color: #666; font-size: 0.9em; margin-top: 5px;">${endpoint.description}</div>
                        <div class="error-message">
                            <strong>üîß Local server not running!</strong><br>
                            Please follow the setup instructions above to start your local test server.
                        </div>
                    `;
                    return;
                }

                const data = await response.json();
                const isSuccess = response.ok;

                resultDiv.className = `result-item ${isSuccess ? 'success' : 'error'}`;
                resultDiv.innerHTML = `
                    <div class="result-header">
                        <span class="endpoint">${endpoint.method} /api/v1/${endpoint.path}</span>
                        <span class="status-badge ${isSuccess ? 'status-success' : 'status-error'}">
                            ${response.status}
                        </span>
                    </div>
                    <div style="color: #666; font-size: 0.9em; margin-top: 5px;">${endpoint.description}</div>
                    ${!isSuccess ? `<div class="error-message">‚ùå Error: ${data.error || data.message || 'Request failed'}</div>` : ''}
                    <details style="margin-top: 15px;">
                        <summary style="cursor: pointer; font-weight: bold; color: #667eea;">üìÑ View Response Data</summary>
                        <div class="response-data">${JSON.stringify(data, null, 2)}</div>
                    </details>
                `;

            } catch (error) {
                resultDiv.className = 'result-item error';
                resultDiv.innerHTML = `
                    <div class="result-header">
                        <span class="endpoint">${endpoint.method} /api/v1/${endpoint.path}</span>
                        <span class="status-badge status-error">Error</span>
                    </div>
                    <div style="color: #666; font-size: 0.9em; margin-top: 5px;">${endpoint.description}</div>
                    <div class="error-message">‚ùå Network Error: ${error.message}</div>
                `;
            }
        }

        async function testAllEndpoints() {
            const testBtn = document.getElementById('test-btn');
            const resultsContainer = document.getElementById('results-container');
            
            testBtn.disabled = true;
            testBtn.textContent = 'üîÑ Testing...';
            resultsContainer.innerHTML = '<p class="loading">üîÑ Testing endpoints via secure proxy...</p>';

            for (const endpoint of endpoints) {
                await testEndpoint(endpoint);
                // Small delay between requests to avoid rate limiting
                await new Promise(resolve => setTimeout(resolve, 1000));
            }

            testBtn.disabled = false;
            testBtn.textContent = 'üöÄ Test All Endpoints';
        }

        function clearResults() {
            document.getElementById('results-container').innerHTML = 
                '<p class="loading">Click "Test All Endpoints" to start testing the Oriva APIs</p>';
        }

        // Check if local server is running on page load
        window.onload = function() {
            // Test if the proxy server is available
            fetch('http://localhost:3000/api/proxy/health')
                .then(response => {
                    if (response.ok) {
                        console.log('‚úÖ Local test server is running');
                    }
                })
                .catch(error => {
                    console.log('‚ö†Ô∏è Local test server not running - follow setup instructions');
                });
        };
    </script>
</body>
</html>